# Use this to get all information needed to generate a widget
query GetActionPage($name: String, $id: Int) {
  actionPage(name: $name, id: $id) {
    config,
    locale,
    journey,
    name,
    campaign {
      title, name, externalId, 
      stats {
        actionCount {
          actionType, count
        }, 
        supporterCount
      },
      org {
        title
      }
    }
  }
}

query GetCount($id: Int!) {
  actionPage(id:$id) {
    campaign {
      stats {
        supporterCount
      }
    }
  }
}

# Use instead of GetcountByUrl (ActionPage.url is deprecated)
query GetCountByName($name: String!) {
  actionPage(name: $name) {
    id, campaign {
      name,
      title,
  		externalId,
      stats {
        supporterCount 
      }
    }
  }
}
query GetActionPagePublicResult($name: String, $id: Int, $actionType: String!) {
  actionPage(name: $name, id: $id) {
    config,
    locale,
    journey,
    name,
    campaign {
      title, name, externalId,
      stats {
        actionCount {
          actionType, count
        }, 
        supporterCount
      },
      actions(actionType: $actionType) {
        fieldKeys, list {  
        actionType, insertedAt,
          fields { key, value }
        }
      },
      org {
        title
      }
    }
  }
}

mutation AddContactAction(
  $id: Int!,
  $contact: ContactInput!, 
  $actionType: String!,
  $fields: [CustomFieldInput!],
  $privacy: ConsentInput!,
  $tracking: TrackingInput
) {
  addActionContact(
    actionPageId: $id,
    contact: $contact,
    action: { actionType: $actionType, fields: $fields }
    privacy: $privacy,
    tracking: $tracking
  ) {
    contactRef, firstName
  }
}


mutation AddAction(
  $id: Int!,
  $contactRef: ID, 
  $actionType: String!,
  $fields: [CustomFieldInput!],
  $tracking: TrackingInput
) {
  addAction(
    actionPageId: $id,
    contactRef: $contactRef,
    action: { actionType: $actionType, fields: $fields }
    tracking: $tracking
  ) {
    contactRef, firstName
  }
}