query ListCampaigns($org: String!) {
    org(name: $org) {
      campaigns {
        id, externalId, name, title,
        org { name, title }
      }
    }
  }

query GetCampaign($org: String!, $id: Int!) {
    org(name: $org) {
      campaign(id: $id) {
        id, externalId, name, title,
        stats {
          supporterCount, actionCount { actionType, count }
        }
      }
    }
  }

query GetActionPage($org: String!, $id: Int, $name: String) {
    org(name: $org) {
      name, title,
      actionPage(id: $id, name: $name) {
        id,
        name,
        locale,
        extraSupporters, thankYouTemplateRef,
        journey,
        config,
        campaign { name, id, externalId }
      }
    }
}

# XXX add optional campaignId param to filter
query ListActionPages($org: String!) {
  org(name: $org) {
    name, 
    title,
    actionPages {
      id, name, locale,
      extraSupporters,
      campaign { name, id, externalId }
    }
  }
}

query ExportCampaignActions($org: String!, $campaignId: Int, $campaignName: String,
                            $start: Int, $after: DateTime, $limit: Int,
                            $onlyOptIn: Boolean) {

      exportActions(orgName: $org, campaignId: $campaignId, campaignName: $campaignName,
                    start: $start, after: $after, limit: $limit, onlyOptIn: $onlyOptIn)
      {
        actionId, actionType, createdAt,
        contact { contactRef, payload, nonce, publicKey { id, public }, signKey { id, public } },
        fields { key, value },
        tracking { source, medium, campaign, content },
        actionPage { id, name },
        privacy { optIn }
      }
}

query ExportOrgActions($org: String!, $start: Int, $after: DateTime, $limit: Int, $onlyOptIn: Boolean) {
      exportActions(orgName: $org, start: $start, after: $after, limit: $limit, onlyOptIn: $onlyOptIn)
      {
        actionId, actionType, createdAt,
        contact { contactRef, payload, nonce, publicKey { id, public }, signKey { id, public } },
        fields { key, value },
        tracking { source, medium, campaign, content },
        actionPage { id, name },
        campaign { name, externalId },
        privacy { optIn }
      }
}

mutation UpdateActionPage(
      $id: Int!,
      $actionPage: ActionPageInput!
      ) {
      updateActionPage(
        id: $id,
        input: $actionPage
      )
      {
        id
      }
  }

mutation UpsertCampaign(
         $org: String!,
         $campaign: CampaignInput!
        ) {
        upsertCampaign(
          orgName: $org,
          input: $campaign
        ) {
          id
        }
      }


query ListKeys($org: String!){
  org(name: $org) { 
    keys { 
      id, name, public, active, expired, expiredAt 
    }
  }
}

mutation GenerateKey($org: String!, $input:GenKeyInput!) {
  generateKey(orgName: $org, input: $input) {
    id, name, public, private, active, expired, expiredAt
  }
}

mutation ActivateKey($org: String!, $id: Int!) {
  activateKey(orgName: $org, id: $id) {
    status
  }
}

mutation AddOrg($org: OrgInput!) {
  addOrg(input: $org) {
    id, name
  }
}

subscription ActionPageUpserted($org: String) {
  actionPageUpserted(orgName: $org) {
    id, name, locale, journey, config,
    campaign { id, name, title, externalId },
    org { title }
  }
}
