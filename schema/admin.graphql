query ListCampaigns($org: String!) {
    org(name: $org) {
      campaigns {
        id, externalId, name, title,
        org { name, title }
      }
    }
  }

query GetCampaign($org: String!, $id: Int!) {
    org(name: $org) {
      campaign(id: $id) {
        id, externalId, name, title,
        stats {
          supporterCount, actionCount { actionType, count }
        }
      }
    }
  }

query GetActionPage($org: String!, $id: Int!) {
    org(name: $org) {
      actionPage(id: $id) {
        id,
        name,
        locale,
        extraSupporters, thankYouTemplateRef,
        journey,
        config,
        campaign { name, id, externalId }
      }
    }
}

# XXX add optional campaignId param to filter
query ListActionPages($org: String!) {
  org(name: $org) {
    actionPages {
      id, name, locale,
      extraSupporters,
      campaign { name, id, externalId }
    }
  }
}

query ExportCampaignActions($org: String!, $campaignId: Int, $campaignName: String!,
                            $start: Int, $after: Datetime, $limit: Int) {

      exportActions(orgName: $org, campaignId: $campaignId, campaignName: $campaignName,
                    start: $start, after: $after, limit: $limit)
      {
        actionId, actionType, createdAt,
        contact { contactRef, payload, nonce, publicKey { id, public }, signKey { id, public } },
        fields { key, value },
        tracking { source, medium, campaign, content },
        actionPage { id, name },
        privacy { optIn }
      }
}

query ExportOrgActions($org: String!, $start: Int,  $limit: Int) {
      exportActions(orgName: $org, start: $start,  limit: $limit)
      {
        actionId, actionType, createdAt,
        contact { contactRef, payload, nonce, publicKey { id, public }, signKey { id, public } },
        fields { key, value },
        tracking { source, medium, campaign, content },
        actionPage { id, name },
        campaign { name, externalId },
        privacy { optIn }
      }
}

mutation UpdateActionPage(
      $id: Int!,
      $name: String,
      $locale: String,
      $thankYouTemplateRef: String,
      $extraSupporters: Int,
      $config: String
      ) {
      updateActionPage(
        id: $id,
        name: $name,
        locale: $locale,
        thankYouTemplateRef: $thankYouTemplateRef,
        extraSupporters: $extraSupporters,
        config: $config)
      {
        id
      }
  }

mutation UpsertCampaign(
         $org: String!,
         $name: String!,
         $externalId: Int,
         $title: String,
         $actionPages: [ActionPageInput]!
        ) {
        upsertCampaign(
          orgName: $org, name: $name, externalId: $externalId, title: $title, actionPages: $actionPages
        ) {
          id
        }
      }


query ListKeys($org: String!){
  org(name: $org) { 
    keys { 
      id, name, public, expiredAt 
    }
  }
}


subscription ActionPageUpserted($org: String) {
  actionPageUpserted(orgName: $org) {
    id, name, locale, journey, config,
    campaign { name, title },
    org { title }
  }
}